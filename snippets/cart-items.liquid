{%- assign for_drawer = false -%}

{%- if section.id == 'mini-cart' -%}
  {%- assign for_drawer = true -%}
{%- endif -%}

<div class="cart__item__container">
  {%- unless for_drawer -%}
    <div class="cart__menu">
      <p class="cart__menu__left">{{ 'cart.items.product' | t }}</p>
      <p class="cart__menu__mid">{{ 'cart.items.quantity' | t }}</p>
      <p class="cart__menu__right">{{ 'cart.items.total' | t }}</p>
    </div>
  {%- endunless -%}

  <ul class="cart__items">
    {%- for line_item in cart.items -%}
    {% comment %} {%- if for_drawer -%}
      <div class="CartItemWrapper">
    {%- endif -%} {% endcomment %}
      <li class="cart__item">
        <div class="cart__item__imageWrapper">
          <img class="cart__item__image" src="{{ line_item.image | img_url: '151px' }}" alt="{{ line_item.image.alt | escape }}">
        </div>

      <div class="cart__item__spContainer">
        <a class="cart__item__productName" href="{{ line_item.url }}">  
          <p>{{ line_item.product.title }}</p>
        </a> 

        {% comment %} <div class="CartItem__Meta Heading Text--subdued">
          {%- unless line_item.product.has_only_default_variant -%}
            <p class="CartItem__Variant">{{ line_item.variant.title }}</p>
          {%- endunless -%}

          {%- if line_item.selling_plan_allocation -%}
            <p class="CartItem__PlanAllocation">{{ line_item.selling_plan_allocation.selling_plan.name }}</p>
          {%- endif -%}

          {%- if line_item.properties != empty -%}
            <ul class="CartItem__PropertyList">
              {%- for property in line_item.properties -%}
                {%- assign first_character_in_key = property.first | truncate: 1, '' -%}

                {%- if property.last == blank or first_character_in_key == '_' -%}
                  {%- continue -%}
                {%- endif -%}

                <li class="CartItem__Property">{{ property.first }}: {{ property.last }}</li>
              {%- endfor -%}
            </ul>
          {%- endif -%}

          {%- if line_item.unit_price_measurement -%}
            <div class="CartItem__UnitPriceMeasurement">
              <div class="UnitPriceMeasurement Heading Text--subdued">
                <span class="UnitPriceMeasurement__Price">{{ line_item.unit_price | money }}</span>
                <span class="UnitPriceMeasurement__Separator">/ </span>

                {%- if line_item.unit_price_measurement.reference_value != 1 -%}
                  <span class="UnitPriceMeasurement__ReferenceValue">{{ line_item.unit_price_measurement.reference_value }}</span>
                {%- endif -%}

                <span class="UnitPriceMeasurement__ReferenceUnit">{{ line_item.unit_price_measurement.reference_unit }}</span>
              </div>
            </div>
          {%- endif -%}
        </div> {% endcomment %}

        {%- capture item_actions -%}
          <div class="cart__item__amount">
            <div class="CartItem__QuantitySelector cart__item__amountSp">
              <div class="QuantitySelector">
                {%- assign quantity_minus_one = line_item.quantity | minus: 1 -%}
                <a class="QuantitySelector__Button Link Link--primary" title="{{ 'cart.items.set_quantity' | t: new_quantity: quantity_minus_one }}" href="{{ routes.cart_change_url }}?quantity={{ quantity_minus_one }}&line={{ forloop.index }}" data-quantity="{{ quantity_minus_one }}" data-line="{{ forloop.index }}" data-action="update-item-quantity">
                  {%- render 'icon' with 'minus' -%}
                </a>
                <input type="text" name="updates[]" id="updates_{{ line_item.key }}" class="QuantitySelector__CurrentQuantity cart__item__quantity" pattern="[0-9]*" data-line="{{ forloop.index }}" value="{{ line_item.quantity }}">
                {%- assign quantity_plus_one = line_item.quantity | plus: 1 -%}
                <a class="QuantitySelector__Button Link Link--primary" title="{{ 'cart.items.set_quantity' | t: new_quantity: quantity_plus_one }}" href="{{ routes.cart_change_url }}?quantity={{ quantity_plus_one }}&line={{ forloop.index }}" data-quantity="{{ quantity_plus_one }}" data-line="{{ forloop.index }}" data-action="update-item-quantity">
                  {%- render 'icon' with 'plus' -%}
                </a>
              </div>
              <a href="{{ routes.cart_change_url }}?quantity=0&line={{ forloop.index }}" class="CartItem__Remove Link Link--underline Link--underlineShort cart__item__quantity" data-quantity="0" data-line="{{ forloop.index }}" data-action="remove-item">{{ 'cart.items.remove' | t }}</a>
            </div>
          </div>
        {%- endcapture -%}


        {%- unless for_drawer -%}
          {{ item_actions }}

          <div class="cart__item__price">
            {%- if line_item.original_line_price != line_item.final_line_price -%}
              {{ line_item.final_line_price | money }}
              {{ line_item.original_line_price | money }}
            {%- else -%}
              {{ line_item.final_line_price | money }}
            {%- endif -%}
          </div>
        {%- endunless -%}
      </div>
      </li>
    {%- if for_drawer -%}
    {%- endif -%}
  {%- endfor -%}
  </ul>
</div>